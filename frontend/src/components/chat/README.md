# AI Agent Chat Integration

This directory contains the chat interface components that integrate with the backend AI agents powered by AWS Bedrock.

## Components

### `chat.tsx`
The main chat interface component that provides:
- Real-time conversation with AI agents
- Agent selection (Legal Drafting, Legal Research, Case Management)
- Session management
- Action execution (document creation, matter setup, deadline management)
- Message status indicators
- Citation display

### `agent-actions.tsx`
Handles the execution of actions generated by AI agents:
- Document creation buttons
- Matter creation buttons
- Deadline management buttons
- Search actions
- Visual action indicators with icons

## Services

### `agent-service.ts`
Manages communication with backend AI agents:
- Session creation and management
- Message sending and receiving
- Agent information retrieval
- Health checking

### `websocket-service.ts`
Handles real-time collaboration features:
- Document editing synchronization
- User presence indicators
- Document locking/unlocking
- Cursor position sharing

## Hooks

### `use-agent.ts`
React hook that provides:
- Agent state management
- Message handling
- Session lifecycle management
- WebSocket integration
- Action parsing from agent responses

## Features

### Agent Capabilities
The chat interface connects to three specialized AI agents:

1. **Legal Drafting Agent** (`legal_drafting`)
   - Contract and document drafting
   - Legal document review
   - Citation validation
   - Template generation

2. **Legal Research Agent** (`legal_research`)
   - Case law research
   - Precedent analysis
   - Statute interpretation
   - Legal trend analysis

3. **Case Management Agent** (`case_management`)
   - Matter organization
   - Deadline tracking
   - Task management
   - Progress reporting

### Real-time Actions
Agents can perform real functions through the chat interface:

- **Document Creation**: Agents can generate documents that appear in the editor
- **Matter Setup**: Agents can create new matters with proper folder structures
- **Deadline Management**: Agents can set up deadlines and calendar events
- **Research Integration**: Agents can perform searches and provide citations

### Session Management
- Persistent sessions across page reloads
- Session cleanup and management
- Multi-agent conversations
- Context preservation

## Usage

```tsx
import Chat from '@/components/chat/chat';

function MyComponent() {
  const handleDocumentCreate = (document) => {
    // Handle document creation
    console.log('Document created:', document);
  };

  const handleMatterCreate = (matter) => {
    // Handle matter creation
    console.log('Matter created:', matter);
  };

  const handleDeadlineCreate = (deadline) => {
    // Handle deadline creation
    console.log('Deadline created:', deadline);
  };

  return (
    <Chat
      onDocumentCreate={handleDocumentCreate}
      onMatterCreate={handleMatterCreate}
      onDeadlineCreate={handleDeadlineCreate}
    />
  );
}
```

## Configuration

### Environment Variables
```bash
# Backend API Configuration
BACKEND_URL=http://localhost:8000
NEXT_PUBLIC_API_URL=/api

# WebSocket Configuration
NEXT_PUBLIC_WS_URL=ws://localhost:8000/api/v1/ws/connect
```

### API Endpoints
The chat interface uses these API endpoints:
- `POST /api/agents/chat` - Send messages to agents
- `POST /api/agents/sessions` - Create new sessions
- `GET /api/agents/sessions/{id}` - Get session info
- `DELETE /api/agents/sessions/{id}` - Close sessions

## Backend Integration

The frontend integrates with the FastAPI backend that provides:
- AWS Bedrock Agents integration
- WebSocket collaboration service
- Document and matter management
- Deadline and task tracking

### Agent Response Format
```json
{
  "response": "Agent response text",
  "session_id": "session_123",
  "agent_name": "legal_drafting",
  "matter_id": "matter_456",
  "citations": [
    {
      "title": "Case Name",
      "url": "https://example.com",
      "snippet": "Relevant text..."
    }
  ]
}
```

### Action Parsing
The system automatically parses agent responses for actionable items:
- `Matter Created:` → Creates matter action button
- `Document generated` → Creates document action button
- `Deadline Created` → Creates deadline action button

## Development

### Running the Chat Interface
1. Start the backend server on port 8000
2. Start the frontend development server
3. Navigate to the chat interface
4. Select an agent and start chatting

### Testing Agent Integration
```bash
# Test agent health
curl http://localhost:8000/api/v1/agents/health

# Test session creation
curl -X POST http://localhost:8000/api/v1/agents/sessions \
  -H "Content-Type: application/json" \
  -d '{"agent_name": "legal_drafting"}'

# Test chat message
curl -X POST http://localhost:8000/api/v1/agents/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "Help me draft a service agreement",
    "agent_name": "legal_drafting"
  }'
```

## Future Enhancements

- Voice input/output integration
- Multi-modal document handling (images, PDFs)
- Advanced collaboration features
- Agent memory and context persistence
- Custom agent training and fine-tuning
- Integration with external legal databases
- Mobile-optimized interface
- Offline capability with sync